/*! For license information please see tableExport.min.js.LICENSE.txt */
"use strict";!function(e){e.fn.tableExport=function(t){var n,o={csvEnclosure:'"',csvSeparator:",",csvUseBOM:!0,date:{html:"dd/mm/yyyy"},displayTableName:!1,escape:!1,exportHiddenCells:!1,fileName:"tableExport",htmlContent:!1,htmlHyperlink:"content",ignoreColumn:[],ignoreRow:[],jsonScope:"all",jspdf:{orientation:"p",unit:"pt",format:"a4",margins:{left:20,right:10,top:10,bottom:10},onDocCreated:null,autotable:{styles:{cellPadding:2,rowHeight:12,fontSize:8,fillColor:255,textColor:50,fontStyle:"normal",overflow:"ellipsize",halign:"inherit",valign:"middle"},headerStyles:{fillColor:[52,73,94],textColor:255,fontStyle:"bold",halign:"inherit",valign:"middle"},alternateRowStyles:{fillColor:245},tableExport:{doc:null,onAfterAutotable:null,onBeforeAutotable:null,onAutotableText:null,onTable:null,outputImages:!0}}},mso:{fileFormat:"xlshtml",onMsoNumberFormat:null,pageFormat:"a4",pageOrientation:"portrait",rtl:!1,styles:[],worksheetName:"",xslx:{formatId:{date:14,numbers:2}}},numbers:{html:{decimalMark:".",thousandsSeparator:","},output:{decimalMark:".",thousandsSeparator:","}},onAfterSaveToFile:null,onBeforeSaveToFile:null,onCellData:null,onCellHtmlData:null,onCellHtmlHyperlink:null,onIgnoreRow:null,onTableExportBegin:null,onTableExportEnd:null,outputMode:"file",pdfmake:{enabled:!1,docDefinition:{pageSize:"A4",pageOrientation:"portrait",styles:{header:{background:"#34495E",color:"#FFFFFF",bold:!0,alignment:"center",fillColor:"#34495E"},alternateRow:{fillColor:"#f5f5f5"}},defaultStyle:{color:"#000000",fontSize:8,font:"Roboto"}},fonts:{}},preserve:{leadingWS:!1,trailingWS:!1},preventInjection:!0,sql:{tableEnclosure:"`",columnEnclosure:"`"},tbodySelector:"tr",tfootSelector:"tr",theadSelector:"tr",tableName:"Table",type:"csv"},r={a0:[2383.94,3370.39],a1:[1683.78,2383.94],a2:[1190.55,1683.78],a3:[841.89,1190.55],a4:[595.28,841.89],a5:[419.53,595.28],a6:[297.64,419.53],a7:[209.76,297.64],a8:[147.4,209.76],a9:[104.88,147.4],a10:[73.7,104.88],b0:[2834.65,4008.19],b1:[2004.09,2834.65],b2:[1417.32,2004.09],b3:[1000.63,1417.32],b4:[708.66,1000.63],b5:[498.9,708.66],b6:[354.33,498.9],b7:[249.45,354.33],b8:[175.75,249.45],b9:[124.72,175.75],b10:[87.87,124.72],c0:[2599.37,3676.54],c1:[1836.85,2599.37],c2:[1298.27,1836.85],c3:[918.43,1298.27],c4:[649.13,918.43],c5:[459.21,649.13],c6:[323.15,459.21],c7:[229.61,323.15],c8:[161.57,229.61],c9:[113.39,161.57],c10:[79.37,113.39],dl:[311.81,623.62],letter:[612,792],"government-letter":[576,756],legal:[612,1008],"junior-legal":[576,360],ledger:[1224,792],tabloid:[792,1224],"credit-card":[153,243]},i=this,a=null,l=[],s=[],c=0,d="",f=[],h=[],u=[],m=!1;if(e.extend(!0,o,t),"xlsx"===o.type&&(o.mso.fileFormat=o.type,o.type="excel"),void 0!==o.excelFileFormat&&"undefined"===o.mso.fileFormat&&(o.mso.fileFormat=o.excelFileFormat),void 0!==o.excelPageFormat&&"undefined"===o.mso.pageFormat&&(o.mso.pageFormat=o.excelPageFormat),void 0!==o.excelPageOrientation&&"undefined"===o.mso.pageOrientation&&(o.mso.pageOrientation=o.excelPageOrientation),void 0!==o.excelRTL&&"undefined"===o.mso.rtl&&(o.mso.rtl=o.excelRTL),void 0!==o.excelstyles&&"undefined"===o.mso.styles&&(o.mso.styles=o.excelstyles),void 0!==o.onMsoNumberFormat&&"undefined"===o.mso.onMsoNumberFormat&&(o.mso.onMsoNumberFormat=o.onMsoNumberFormat),void 0!==o.worksheetName&&"undefined"===o.mso.worksheetName&&(o.mso.worksheetName=o.worksheetName),o.mso.pageOrientation="l"===o.mso.pageOrientation.substr(0,1)?"landscape":"portrait",o.date.html=o.date.html||"",o.date.html.length){var p=[];p.dd="(3[01]|[12][0-9]|0?[1-9])",p.mm="(1[012]|0?[1-9])",p.yyyy="((?:1[6-9]|2[0-2])\\d{2})",p.yy="(\\d{2})";var g=o.date.html.match(/[^a-zA-Z0-9]/)[0],y=o.date.html.toLowerCase().split(g);o.date.regex="^\\s*",o.date.regex+=p[y[0]],o.date.regex+="(.)",o.date.regex+=p[y[1]],o.date.regex+="\\2",o.date.regex+=p[y[2]],o.date.regex+="\\s*$",o.date.pattern=new RegExp(o.date.regex,"g");var v=y.indexOf("dd")+1;o.date.match_d=v+(v>1?1:0),v=y.indexOf("mm")+1,o.date.match_m=v+(v>1?1:0),v=(y.indexOf("yyyy")>=0?y.indexOf("yyyy"):y.indexOf("yy"))+1,o.date.match_y=v+(v>1?1:0)}if(f=ne(i),"function"==typeof o.onTableExportBegin&&o.onTableExportBegin(),"csv"===o.type||"tsv"===o.type||"txt"===o.type){var b="",x=0;h=[],c=0;var w=function(t,n,r){return t.each((function(){d="",ie(this,n,c,r+t.length,(function(e,t,n){d+=function(e,t,n){var r="";if(null!==e){var i=ye(e,t,n),a=null===i||""===i?"":i.toString();"tsv"===o.type?(i instanceof Date&&i.toLocaleString(),r=he(a,"\t"," ")):i instanceof Date?r=o.csvEnclosure+i.toLocaleString()+o.csvEnclosure:((r=he(r=ve(a),o.csvEnclosure,o.csvEnclosure+o.csvEnclosure)).indexOf(o.csvSeparator)>=0||/[\r\n ]/g.test(r))&&(r=o.csvEnclosure+r+o.csvEnclosure)}return r}(e,t,n)+("tsv"===o.type?"\t":o.csvSeparator)})),(d=e.trim(d).substring(0,d.length-1)).length>0&&(b.length>0&&(b+="\n"),b+=d),c++})),t.length};if(x+=w(e(i).find("thead").first().find(o.theadSelector),"th,td",x),te(e(i),"tbody").each((function(){x+=w(te(e(this),o.tbodySelector),"td,th",x)})),o.tfootSelector.length&&w(e(i).find("tfoot").first().find(o.tfootSelector),"td,th",x),b+="\n","string"===o.outputMode)return b;if("base64"===o.outputMode)return Ae(b);if("window"===o.outputMode)return void Me(!1,"data:text/"+("csv"===o.type?"csv":"plain")+";charset=utf-8,",b);Ee(b,o.fileName+"."+o.type,"text/"+("csv"===o.type?"csv":"plain"),"utf-8","","csv"===o.type&&o.csvUseBOM)}else if("sql"===o.type){c=0,h=[];var S="INSERT INTO "+o.sql.tableEnclosure+o.tableName+o.sql.tableEnclosure+" (";if(l=G(e(i)),e(l).each((function(){ie(this,"th,td",c,l.length,(function(e,t,n){var r=ye(e,t,n)||"";r.indexOf(o.sql.columnEnclosure)>-1&&(r=he(r.toString(),o.sql.columnEnclosure,o.sql.columnEnclosure+o.sql.columnEnclosure)),S+=o.sql.columnEnclosure+r+o.sql.columnEnclosure+","})),c++,S=e.trim(S).substring(0,S.length-1)})),S+=") VALUES ",s=ee(e(i)),e(s).each((function(){d="",ie(this,"td,th",c,l.length+s.length,(function(e,t,n){var o=ye(e,t,n)||"";o.indexOf("'")>-1&&(o=he(o.toString(),"'","''")),d+="'"+o+"',"})),d.length>3&&(S+="("+d,S=e.trim(S).substring(0,S.length-1),S+="),"),c++})),S=e.trim(S).substring(0,S.length-1),S+=";","string"===o.outputMode)return S;if("base64"===o.outputMode)return Ae(S);Ee(S,o.fileName+".sql","application/sql","utf-8","",!1)}else if("json"===o.type){var C=[];h=[],l=G(e(i)),e(l).each((function(){var e=[];ie(this,"th,td",c,l.length,(function(t,n,o){e.push(ye(t,n,o))})),C.push(e)}));var k,F=[];if(s=ee(e(i)),e(s).each((function(){var t={},n=0;ie(this,"td,th",c,l.length+s.length,(function(e,o,r){C.length?t[C[C.length-1][n]]=ye(e,o,r):t[n]=ye(e,o,r),n++})),!1===e.isEmptyObject(t)&&F.push(t),c++})),k="head"===o.jsonScope?JSON.stringify(C):"data"===o.jsonScope?JSON.stringify(F):JSON.stringify({header:C,data:F}),"string"===o.outputMode)return k;if("base64"===o.outputMode)return Ae(k);Ee(k,o.fileName+".json","application/json","utf-8","base64",!1)}else if("xml"===o.type){c=0,h=[];var T='<?xml version="1.0" encoding="utf-8"?>';T+="<tabledata><fields>",l=G(e(i)),e(l).each((function(){ie(this,"th,td",c,l.length,(function(e,t,n){T+="<field>"+ye(e,t,n)+"</field>"})),c++})),T+="</fields><data>";var N=1;if(s=ee(e(i)),e(s).each((function(){var e=1;d="",ie(this,"td,th",c,l.length+s.length,(function(t,n,o){d+="<column-"+e+">"+ye(t,n,o)+"</column-"+e+">",e++})),d.length>0&&"<column-1></column-1>"!==d&&(T+='<row id="'+N+'">'+d+"</row>",N++),c++})),T+="</data></tabledata>","string"===o.outputMode)return T;if("base64"===o.outputMode)return Ae(T);Ee(T,o.fileName+".xml","application/xml","utf-8","base64",!1)}else if("excel"===o.type&&"xmlss"===o.mso.fileFormat){var R=[],O=[];e(i).filter((function(){return oe(e(this))})).each((function(){var t=e(this),n="";function r(t,n,o){var r=[];return e(t).each((function(){var n=0,i=0;d="",ie(this,"td,th",c,o+t.length,(function(t,o,a){if(null!==t){var l="",s=ye(t,o,a),f="String";if(!1!==jQuery.isNumeric(s))f="Number";else{var h=((p=s).indexOf("%")>-1?!1!==(p=ge(p.replace(/%/g,"")))&&(p/=100):p=!1,p);!1!==h&&(s=h,f="Number",l+=' ss:StyleID="pct1"')}"Number"!==f&&(s=s.replace(/\n/g,"<br>"));var u=Se(t),m=Ce(t);e.each(r,(function(){var e=this;if(c>=e.s.r&&c<=e.e.r&&i>=e.s.c&&i<=e.e.c)for(var t=0;t<=e.e.c-e.s.c;++t)i++,n++})),(m||u)&&(m=m||1,u=u||1,r.push({s:{r:c,c:i},e:{r:c+m-1,c:i+u-1}})),u>1&&(l+=' ss:MergeAcross="'+(u-1)+'"',i+=u-1),m>1&&(l+=' ss:MergeDown="'+(m-1)+'" ss:StyleID="rsp1"'),n>0&&(l+=' ss:Index="'+(i+1)+'"',n=0),d+="<Cell"+l+'><Data ss:Type="'+f+'">'+e("<div />").text(s).html()+"</Data></Cell>\r",i++}var p})),d.length>0&&(X+='<Row ss:AutoFitHeight="0">\r'+d+"</Row>\r"),c++})),t.length}"string"==typeof o.mso.worksheetName&&o.mso.worksheetName.length?n=o.mso.worksheetName+" "+(O.length+1):void 0!==o.mso.worksheetName[O.length]&&(n=o.mso.worksheetName[O.length]),n.length||(n=t.find("caption").text()||""),n.length||(n="Table "+(O.length+1)),n=e.trim(n.replace(/[\\\/[\]*:?'"]/g,"").substring(0,31)),O.push(e("<div />").text(n).html()),!1===o.exportHiddenCells&&(u=t.find("tr, th, td").filter(":hidden"),m=u.length>0),c=0,f=ne(this),X="<Table>\r";var i=r(G(t),0,0);r(ee(t),0,i),X+="</Table>\r",R.push(X)}));for(var E,M,A={},I={},D=0,W=O.length;D<W;D++)M=A[E=O[D]],2===(M=A[E]=null==M?1:M+1)&&(O[I[E]]=O[I[E]].substring(0,29)+"-1"),A[E]>1?O[D]=O[D].substring(0,29)+"-"+A[E]:I[E]=D;for(var P='<?xml version="1.0" encoding="UTF-8"?>\r<?mso-application progid="Excel.Sheet"?>\r<Workbook xmlns="urn:schemas-microsoft-com:office:spreadsheet"\r xmlns:o="urn:schemas-microsoft-com:office:office"\r xmlns:x="urn:schemas-microsoft-com:office:excel"\r xmlns:ss="urn:schemas-microsoft-com:office:spreadsheet"\r xmlns:html="http://www.w3.org/TR/REC-html40">\r<DocumentProperties xmlns="urn:schemas-microsoft-com:office:office">\r  <Created>'+(new Date).toISOString()+'</Created>\r</DocumentProperties>\r<OfficeDocumentSettings xmlns="urn:schemas-microsoft-com:office:office">\r  <AllowPNG/>\r</OfficeDocumentSettings>\r<ExcelWorkbook xmlns="urn:schemas-microsoft-com:office:excel">\r  <WindowHeight>9000</WindowHeight>\r  <WindowWidth>13860</WindowWidth>\r  <WindowTopX>0</WindowTopX>\r  <WindowTopY>0</WindowTopY>\r  <ProtectStructure>False</ProtectStructure>\r  <ProtectWindows>False</ProtectWindows>\r</ExcelWorkbook>\r<Styles>\r  <Style ss:ID="Default" ss:Name="Normal">\r    <Alignment ss:Vertical="Bottom"/>\r    <Borders/>\r    <Font/>\r    <Interior/>\r    <NumberFormat/>\r    <Protection/>\r  </Style>\r  <Style ss:ID="rsp1">\r    <Alignment ss:Vertical="Center"/>\r  </Style>\r  <Style ss:ID="pct1">\r    <NumberFormat ss:Format="Percent"/>\r  </Style>\r</Styles>\r',j=0;j<R.length;j++)P+='<Worksheet ss:Name="'+O[j]+'" ss:RightToLeft="'+(o.mso.rtl?"1":"0")+'">\r'+R[j],o.mso.rtl?P+='<WorksheetOptions xmlns="urn:schemas-microsoft-com:office:excel">\r<DisplayRightToLeft/>\r</WorksheetOptions>\r':P+='<WorksheetOptions xmlns="urn:schemas-microsoft-com:office:excel"/>\r',P+="</Worksheet>\r";if(P+="</Workbook>\r","string"===o.outputMode)return P;if("base64"===o.outputMode)return Ae(P);Ee(P,o.fileName+".xml","application/xml","utf-8","base64",!1)}else if("excel"===o.type&&"xlsx"===o.mso.fileFormat){var L=[],U=XLSX.utils.book_new();e(i).filter((function(){return oe(e(this))})).each((function(){var t=e(this),n=function(t){for(var n,r,i,a,l,s={},c=t.getElementsByTagName("tr"),d=1e7,f={s:{r:0,c:0},e:{r:0,c:0}},h=[],u=0,m=[],p=0,g=0,y=XLSX.SSF.get_table();p<c.length&&g<d;++p){var v=c[p],b=!1;if("function"==typeof o.onIgnoreRow&&(b=o.onIgnoreRow(e(v),p)),!0!==b&&(0===o.ignoreRow.length||-1===e.inArray(p,o.ignoreRow)&&-1===e.inArray(p-c.length,o.ignoreRow))&&!1!==oe(e(v))){var x=v.children,w=0;for(n=0;n<x.length;++n)w+=a=+Se(l=x[n])||1;var S=0;for(n=r=0;n<x.length;++n){a=+Se(l=x[n])||1;var C=n+S;if(!re(e(l),w,C+(C<r?r-C:0))){for(S+=a-1,u=0;u<h.length;++u){var k=h[u];k.s.c==r&&k.s.r<=g&&g<=k.e.r&&(r=k.e.c+1,u=-1)}((i=+Ce(l))>0||a>1)&&h.push({s:{r:g,c:r},e:{r:g+(i||1)-1,c:r+a-1}});var F,T={type:""},N=ye(l,p,n+S,T),R={t:"s",v:N},O="";if(""!==(e(l).attr("data-tableexport-cellformat")||"")){var E=parseInt(e(l).attr("data-tableexport-xlsxformatid")||0);0===E&&"function"==typeof o.mso.xslx.formatId.numbers&&(E=o.mso.xslx.formatId.numbers(e(l),p,n+S)),0===E&&"function"==typeof o.mso.xslx.formatId.date&&(E=o.mso.xslx.formatId.date(e(l),p,n+S)),49===E||"@"===E?O="s":"number"===T.type||E>0&&E<14||E>36&&E<41||48===E?O="n":("date"===T.type||E>13&&E<37||E>44&&E<48||56===E)&&(O="d")}else O="s";if(null!=N)if(0===N.length)R.t="z";else if(0===N.trim().length);else if("s"===O)e(l).find("a").length&&(N="href"!==o.htmlHyperlink?N:"",R={f:'=HYPERLINK("'+e(l).find("a").attr("href")+(N.length?'","'+N:"")+'")'});else if("function"===T.type)R={f:N};else if("TRUE"===N)R={t:"b",v:!0};else if("FALSE"===N)R={t:"b",v:!1};else if("n"===O||isFinite(Re(N,o.numbers.output))){var M=Re(N,o.numbers.output);0===E&&"function"!=typeof o.mso.xslx.formatId.numbers&&(E=o.mso.xslx.formatId.numbers),(isFinite(M)||isFinite(N))&&(R={t:"n",v:isFinite(M)?M:N,z:"string"==typeof E?E:E in y?y[E]:"0.00"})}else!1===(F=pe(N))&&"d"!==O||(0===E&&"function"!=typeof o.mso.xslx.formatId.date&&(E=o.mso.xslx.formatId.date),R={t:"d",v:!1!==F?F:N,z:"string"==typeof E?E:E in y?y[E]:"m/d/yy"});s[Te({c:r,r:g})]=R,f.e.c<r&&(f.e.c=r),r+=a}}++g}}return h.length&&(s["!merges"]=h),m.length&&(s["!rows"]=m),f.e.r=g-1,s["!ref"]=Ne(f),g>=d&&(s["!fullref"]=Ne((f.e.r=c.length-p+g-1,f))),s}(this),r="";"string"==typeof o.mso.worksheetName&&o.mso.worksheetName.length?r=o.mso.worksheetName+" "+(L.length+1):void 0!==o.mso.worksheetName[L.length]&&(r=o.mso.worksheetName[L.length]),r.length||(r=t.find("caption").text()||""),r.length||(r="Table "+(L.length+1)),r=e.trim(r.replace(/[\\\/[\]*:?'"]/g,"").substring(0,31)),L.push(r),XLSX.utils.book_append_sheet(U,n,r)})),Ee(function(e){for(var t=new ArrayBuffer(e.length),n=new Uint8Array(t),o=0;o!==e.length;++o)n[o]=255&e.charCodeAt(o);return t}(XLSX.write(U,{type:"binary",bookType:o.mso.fileFormat,bookSST:!1})),o.fileName+"."+o.mso.fileFormat,"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet","UTF-8","",!1)}else if("excel"===o.type||"xls"===o.type||"word"===o.type||"doc"===o.type){var H="excel"===o.type||"xls"===o.type?"excel":"word",B="excel"===H?"xls":"doc",z='xmlns:x="urn:schemas-microsoft-com:office:'+H+'"',X="",q="";e(i).filter((function(){return oe(e(this))})).each((function(){var t=e(this);""===q&&(q=o.mso.worksheetName||t.find("caption").text()||"Table",q=e.trim(q.replace(/[\\\/[\]*:?'"]/g,"").substring(0,31))),!1===o.exportHiddenCells&&(u=t.find("tr, th, td").filter(":hidden"),m=u.length>0),c=0,h=[],f=ne(this),X+="<table><thead>",l=G(t),e(l).each((function(){var t=e(this);d="",ie(this,"th,td",c,l.length,(function(e,n,r){if(null!==e){var i="";if(d+="<th",o.mso.styles.length){var a=document.defaultView.getComputedStyle(e,null),l=document.defaultView.getComputedStyle(t[0],null);for(var s in o.mso.styles){var c=a[o.mso.styles[s]];""===c&&(c=l[o.mso.styles[s]]),""!==c&&"0px none rgb(0, 0, 0)"!==c&&"rgba(0, 0, 0, 0)"!==c&&(i+=""===i?'style="':";",i+=o.mso.styles[s]+":"+c)}}""!==i&&(d+=" "+i+'"');var f=Se(e);f>0&&(d+=' colspan="'+f+'"');var h=Ce(e);h>0&&(d+=' rowspan="'+h+'"'),d+=">"+ye(e,n,r)+"</th>"}})),d.length>0&&(X+="<tr>"+d+"</tr>"),c++})),X+="</thead><tbody>",s=ee(t),e(s).each((function(){var t=e(this);d="",ie(this,"td,th",c,l.length+s.length,(function(n,r,i){if(null!==n){var a=ye(n,r,i),l="",s=e(n).attr("data-tableexport-msonumberformat");if(void 0===s&&"function"==typeof o.mso.onMsoNumberFormat&&(s=o.mso.onMsoNumberFormat(n,r,i)),void 0!==s&&""!==s&&(l="style=\"mso-number-format:'"+s+"'"),o.mso.styles.length){var c=document.defaultView.getComputedStyle(n,null),f=document.defaultView.getComputedStyle(t[0],null);for(var h in o.mso.styles)""===(s=c[o.mso.styles[h]])&&(s=f[o.mso.styles[h]]),""!==s&&"0px none rgb(0, 0, 0)"!==s&&"rgba(0, 0, 0, 0)"!==s&&(l+=""===l?'style="':";",l+=o.mso.styles[h]+":"+s)}d+="<td",""!==l&&(d+=" "+l+'"');var u=Se(n);u>0&&(d+=' colspan="'+u+'"');var m=Ce(n);m>0&&(d+=' rowspan="'+m+'"'),"string"==typeof a&&""!==a&&(a=(a=ve(a)).replace(/\n/g,"<br>")),d+=">"+a+"</td>"}})),d.length>0&&(X+="<tr>"+d+"</tr>"),c++})),o.displayTableName&&(X+="<tr><td></td></tr><tr><td></td></tr><tr><td>"+ye(e("<p>"+o.tableName+"</p>"))+"</td></tr>"),X+="</tbody></table>"}));var K='<html xmlns:o="urn:schemas-microsoft-com:office:office" '+z+' xmlns="http://www.w3.org/TR/REC-html40">';if(K+='<meta http-equiv="content-type" content="application/vnd.ms-'+H+'; charset=UTF-8">',K+="<head>","excel"===H&&(K+="\x3c!--[if gte mso 9]>",K+="<xml>",K+="<x:ExcelWorkbook>",K+="<x:ExcelWorksheets>",K+="<x:ExcelWorksheet>",K+="<x:Name>",K+=q,K+="</x:Name>",K+="<x:WorksheetOptions>",K+="<x:DisplayGridlines/>",o.mso.rtl&&(K+="<x:DisplayRightToLeft/>"),K+="</x:WorksheetOptions>",K+="</x:ExcelWorksheet>",K+="</x:ExcelWorksheets>",K+="</x:ExcelWorkbook>",K+="</xml>",K+="<![endif]--\x3e"),K+="<style>",K+="@page { size:"+o.mso.pageOrientation+"; mso-page-orientation:"+o.mso.pageOrientation+"; }",K+="@page Section1 {size:"+r[o.mso.pageFormat][0]+"pt "+r[o.mso.pageFormat][1]+"pt",K+="; margin:1.0in 1.25in 1.0in 1.25in;mso-header-margin:.5in;mso-footer-margin:.5in;mso-paper-source:0;}",K+="div.Section1 {page:Section1;}",K+="@page Section2 {size:"+r[o.mso.pageFormat][1]+"pt "+r[o.mso.pageFormat][0]+"pt",K+=";mso-page-orientation:"+o.mso.pageOrientation+";margin:1.25in 1.0in 1.25in 1.0in;mso-header-margin:.5in;mso-footer-margin:.5in;mso-paper-source:0;}",K+="div.Section2 {page:Section2;}",K+="br {mso-data-placement:same-cell;}",K+="</style>",K+="</head>",K+="<body>",K+='<div class="Section'+("landscape"===o.mso.pageOrientation?"2":"1")+'">',K+=X,K+="</div>",K+="</body>",K+="</html>","string"===o.outputMode)return K;if("base64"===o.outputMode)return Ae(K);Ee(K,o.fileName+"."+B,"application/vnd.ms-"+H,"","base64",!1)}else if("png"===o.type)html2canvas(e(i)[0]).then((function(e){for(var t=e.toDataURL(),n=atob(t.substring(22)),r=new ArrayBuffer(n.length),i=new Uint8Array(r),a=0;a<n.length;a++)i[a]=n.charCodeAt(a);return"string"===o.outputMode?n:"base64"===o.outputMode?Ae(t):void("window"!==o.outputMode?Ee(r,o.fileName+".png","image/png","","",!1):window.open(t))}));else if("pdf"===o.type)if(!0===o.pdfmake.enabled){var $={content:[]};e.extend(!0,$,o.pdfmake.docDefinition),h=[],e(i).filter((function(){return oe(e(this))})).each((function(){var t=e(this),n=[],r=[];c=0;for(var i=function(t,n,o){var i=0;return e(t).each((function(){var e=[];ie(this,n,c,o,(function(t,o,r){var i;if(null!=t){var a=Se(t),l=Ce(t);i={text:ye(t,o,r)||" "},(a>1||l>1)&&(i.colSpan=a||1,i.rowSpan=l||1)}else i={text:" "};n.indexOf("th")>=0&&(i.style="header"),e.push(i)})),e.length&&r.push(e),i<e.length&&(i=e.length),c++})),i},a=i(l=G(t),"th,td",l.length),d=n.length;d<a;d++)n.push("*");for(a=i(s=ee(t),"td",l.length+s.length),d=n.length;d<a;d++)n.push("*");$.content.push({table:{headerRows:l.length?l.length:null,widths:n,body:r},layout:{layout:"noBorders",hLineStyle:function(e,t){return 0},vLineWidth:function(e,t){return 0},hLineColor:function(e,t){return e<t.table.headerRows?o.pdfmake.docDefinition.styles.header.background:o.pdfmake.docDefinition.styles.alternateRow.fillColor},vLineColor:function(e,t){return e<t.table.headerRows?o.pdfmake.docDefinition.styles.header.background:o.pdfmake.docDefinition.styles.alternateRow.fillColor},fillColor:function(e,t,n){return e%2==0?o.pdfmake.docDefinition.styles.alternateRow.fillColor:null}},pageBreak:$.content.length?"before":void 0})})),"undefined"!=typeof pdfMake&&void 0!==pdfMake.createPdf&&(pdfMake.fonts={Roboto:{normal:"Roboto-Regular.ttf",bold:"Roboto-Medium.ttf",italics:"Roboto-Italic.ttf",bolditalics:"Roboto-MediumItalic.ttf"}},pdfMake.vfs.hasOwnProperty("Mirza-Regular.ttf")?($.defaultStyle.font="Mirza",e.extend(!0,pdfMake.fonts,{Mirza:{normal:"Mirza-Regular.ttf",bold:"Mirza-Bold.ttf",italics:"Mirza-Medium.ttf",bolditalics:"Mirza-SemiBold.ttf"}})):pdfMake.vfs.hasOwnProperty("gbsn00lp.ttf")?($.defaultStyle.font="gbsn00lp",e.extend(!0,pdfMake.fonts,{gbsn00lp:{normal:"gbsn00lp.ttf",bold:"gbsn00lp.ttf",italics:"gbsn00lp.ttf",bolditalics:"gbsn00lp.ttf"}})):pdfMake.vfs.hasOwnProperty("ZCOOLXiaoWei-Regular.ttf")&&($.defaultStyle.font="ZCOOLXiaoWei",e.extend(!0,pdfMake.fonts,{ZCOOLXiaoWei:{normal:"ZCOOLXiaoWei-Regular.ttf",bold:"ZCOOLXiaoWei-Regular.ttf",italics:"ZCOOLXiaoWei-Regular.ttf",bolditalics:"ZCOOLXiaoWei-Regular.ttf"}})),e.extend(!0,pdfMake.fonts,o.pdfmake.fonts),pdfMake.createPdf($).getBuffer((function(e){Ee(e,o.fileName+".pdf","application/pdf","","",!1)})))}else if(!1===o.jspdf.autotable){var _={dim:{w:Fe(e(i).first().get(0),"width","mm"),h:Fe(e(i).first().get(0),"height","mm")},pagesplit:!1},Z=new jsPDF(o.jspdf.orientation,o.jspdf.unit,o.jspdf.format);Z.addHTML(e(i).first(),o.jspdf.margins.left,o.jspdf.margins.top,_,(function(){le(Z,!1)}))}else{var V=o.jspdf.autotable.tableExport;if("string"==typeof o.jspdf.format&&"bestfit"===o.jspdf.format.toLowerCase()){var Y="",Q="",J=0;e(i).each((function(){if(oe(e(this))){var t=Fe(e(this).get(0),"width","pt");if(t>J){for(var n in t>r.a0[0]&&(Y="a0",Q="l"),r)r.hasOwnProperty(n)&&r[n][1]>t&&(Y=n,Q="l",r[n][0]>t&&(Q="p"));J=t}}})),o.jspdf.format=""===Y?"a4":Y,o.jspdf.orientation=""===Q?"w":Q}null==V.doc&&(V.doc=new jsPDF(o.jspdf.orientation,o.jspdf.unit,o.jspdf.format),V.wScaleFactor=1,V.hScaleFactor=1,"function"==typeof o.jspdf.onDocCreated&&o.jspdf.onDocCreated(V.doc)),!0===V.outputImages&&(V.images={}),void 0!==V.images&&(e(i).filter((function(){return oe(e(this))})).each((function(){var t=0;h=[],!1===o.exportHiddenCells&&(u=e(this).find("tr, th, td").filter(":hidden"),m=u.length>0),l=G(e(this)),s=ee(e(this)),e(s).each((function(){ie(this,"td,th",l.length+t,l.length+s.length,(function(t){ce(t,e(t).children(),V)})),t++}))})),l=[],s=[]),function(t,n){var o=0;function r(){n()}function i(t){if(t.url)if(t.src){var n=new Image;++o,n.crossOrigin="Anonymous",n.onerror=n.onload=function(){if(n.complete&&(0===n.src.indexOf("data:image/")&&(n.width=t.width||n.width||0,n.height=t.height||n.height||0),n.width+n.height)){var e=document.createElement("canvas"),i=e.getContext("2d");e.width=n.width,e.height=n.height,i.drawImage(n,0,0),t.src=e.toDataURL("image/png")}--o||r()},n.src=t.url}else{var i=e(t.url);i.length&&(++o,html2canvas(i[0]).then((function(e){t.src=e.toDataURL("image/png"),--o||r()})))}}if(void 0!==t.images)for(var a in t.images)t.images.hasOwnProperty(a)&&i(t.images[a]);o||r()}(V,(function(){e(i).filter((function(){return oe(e(this))})).each((function(){var t;if(c=0,h=[],!1===o.exportHiddenCells&&(u=e(this).find("tr, th, td").filter(":hidden"),m=u.length>0),f=ne(this),V.columns=[],V.rows=[],V.teCells={},"function"==typeof V.onTable&&!1===V.onTable(e(this),o))return!0;o.jspdf.autotable.tableExport=null;var n=e.extend(!0,{},o.jspdf.autotable);if(o.jspdf.autotable.tableExport=V,n.margin={},e.extend(!0,n.margin,o.jspdf.margins),n.tableExport=V,"function"!=typeof n.beforePageContent&&(n.beforePageContent=function(t){if(1===t.pageCount){var n=t.table.rows.concat(t.table.headerRow);e.each(n,(function(){var e=this;e.height>0&&(e.height+=.42500000000000004*e.styles.fontSize,t.table.height+=.42500000000000004*e.styles.fontSize)}))}}),"function"!=typeof n.createdHeaderCell&&(n.createdHeaderCell=function(t,o){if(t.styles=e.extend({},o.row.styles),void 0!==V.columns[o.column.dataKey]){var r,i=V.columns[o.column.dataKey];void 0!==i.rect&&(t.contentWidth=i.rect.width,void 0!==V.heightRatio&&0!==V.heightRatio||(r=o.row.raw[o.column.dataKey].rowspan?o.row.raw[o.column.dataKey].rect.height/o.row.raw[o.column.dataKey].rowspan:o.row.raw[o.column.dataKey].rect.height,V.heightRatio=t.styles.rowHeight/r),(r=o.row.raw[o.column.dataKey].rect.height*V.heightRatio)>t.styles.rowHeight&&(t.styles.rowHeight=r)),t.styles.halign="inherit"===n.headerStyles.halign?"center":n.headerStyles.halign,t.styles.valign=n.headerStyles.valign,void 0!==i.style&&!0!==i.style.hidden&&("inherit"===n.headerStyles.halign&&(t.styles.halign=i.style.align),"inherit"===n.styles.fillColor&&(t.styles.fillColor=i.style.bcolor),"inherit"===n.styles.textColor&&(t.styles.textColor=i.style.color),"inherit"===n.styles.fontStyle&&(t.styles.fontStyle=i.style.fstyle))}}),"function"!=typeof n.createdCell&&(n.createdCell=function(e,t){var o=V.teCells[t.row.index+":"+t.column.dataKey];e.styles.halign="inherit"===n.styles.halign?"center":n.styles.halign,e.styles.valign=n.styles.valign,void 0!==o&&void 0!==o.style&&!0!==o.style.hidden&&("inherit"===n.styles.halign&&(e.styles.halign=o.style.align),"inherit"===n.styles.fillColor&&(e.styles.fillColor=o.style.bcolor),"inherit"===n.styles.textColor&&(e.styles.textColor=o.style.color),"inherit"===n.styles.fontStyle&&(e.styles.fontStyle=o.style.fstyle))}),"function"!=typeof n.drawHeaderCell&&(n.drawHeaderCell=function(e,t){var n=V.columns[t.column.dataKey];return(!0!==n.style.hasOwnProperty("hidden")||!0!==n.style.hidden)&&n.rowIndex>=0&&se(e,t,n)}),"function"!=typeof n.drawCell&&(n.drawCell=function(t,n){var o=V.teCells[n.row.index+":"+n.column.dataKey];if(!0!==(void 0!==o&&o.isCanvas)){if(se(t,n,o))if(V.doc.rect(t.x,t.y,t.width,t.height,t.styles.fillStyle),void 0===o||void 0!==o.hasUserDefText&&!0===o.hasUserDefText||void 0===o.elements||!o.elements.length)fe(t,{},V);else{var r=t.height/o.rect.height;r>V.hScaleFactor&&(V.hScaleFactor=r),V.wScaleFactor=t.width/o.rect.width;var i=t.textPos.y;de(t,o.elements,V),t.textPos.y=i,fe(t,o.elements,V)}}else{var a=o.elements[0],l=e(a).attr("data-tableexport-canvas"),s=a.getBoundingClientRect();t.width=s.width*V.wScaleFactor,t.height=s.height*V.hScaleFactor,n.row.height=t.height,ae(t,a,l,V)}return!1}),V.headerrows=[],l=G(e(this)),e(l).each((function(){t=0,V.headerrows[c]=[],ie(this,"th,td",c,l.length,(function(e,n,o){var r=we(e);r.title=ye(e,n,o),r.key=t++,r.rowIndex=c,V.headerrows[c].push(r)})),c++})),c>0)for(var r=c-1;r>=0;)e.each(V.headerrows[r],(function(){var e=this;r>0&&null===this.rect&&(e=V.headerrows[r-1][this.key]),null!==e&&e.rowIndex>=0&&(!0!==e.style.hasOwnProperty("hidden")||!0!==e.style.hidden)&&V.columns.push(e)})),r=V.columns.length>0?-1:r-1;var i=0;s=[],s=ee(e(this)),e(s).each((function(){var n=[];t=0,ie(this,"td,th",c,l.length+s.length,(function(o,r,a){var l;void 0===V.columns[t]&&(l={title:"",key:t,style:{hidden:!0}},V.columns.push(l)),n.push(ye(o,r,a)),null!=o?((l=we(o)).isCanvas=o.hasAttribute("data-tableexport-canvas"),l.elements=l.isCanvas?e(o):e(o).children(),void 0!==e(o).data("teUserDefText")&&(l.hasUserDefText=!0),V.teCells[i+":"+t++]=l):((l=e.extend(!0,{},V.teCells[i+":"+(t-1)])).colspan=-1,V.teCells[i+":"+t++]=l)})),n.length&&(V.rows.push(n),i++),c++})),"function"==typeof V.onBeforeAutotable&&V.onBeforeAutotable(e(this),V.columns,V.rows,n),V.doc.autoTable(V.columns,V.rows,n),"function"==typeof V.onAfterAutotable&&V.onAfterAutotable(e(this),n),o.jspdf.autotable.startY=V.doc.autoTableEndPosY()+n.margin.top})),le(V.doc,void 0!==V.images&&!1===jQuery.isEmptyObject(V.images)),void 0!==V.headerrows&&(V.headerrows.length=0),void 0!==V.columns&&(V.columns.length=0),void 0!==V.rows&&(V.rows.length=0),delete V.doc,V.doc=null}))}function G(t){var n=[];return te(t,"thead").each((function(){n.push.apply(n,te(e(this),o.theadSelector).toArray())})),n}function ee(t){var n=[];return te(t,"tbody").each((function(){n.push.apply(n,te(e(this),o.tbodySelector).toArray())})),o.tfootSelector.length&&te(t,"tfoot").each((function(){n.push.apply(n,te(e(this),o.tfootSelector).toArray())})),n}function te(t,n){var o=t[0].tagName,r=t.parents(o).length;return t.find(n).filter((function(){return r===e(this).closest(o).parents(o).length}))}function ne(t){var n=[],o=0,r=0,i=0;return e(t).find("thead").first().find("th").each((function(t,a){var l=void 0!==e(a).attr("data-field");void 0!==a.parentNode.rowIndex&&r!==a.parentNode.rowIndex&&(r=a.parentNode.rowIndex,i=0,o=0);var s=Se(a);for(o+=s||1;i<o;)n[i]=l?e(a).attr("data-field"):i.toString(),i++})),n}function oe(t){var n=void 0!==t[0].rowIndex,o=!1===n&&void 0!==t[0].cellIndex,r=o||n?function(e){var t=[];return m&&(t=u.filter((function(){var t=!1;return this.nodeType===e[0].nodeType&&(void 0!==this.rowIndex&&this.rowIndex===e[0].rowIndex||void 0!==this.cellIndex&&this.cellIndex===e[0].cellIndex&&void 0!==this.parentNode.rowIndex&&void 0!==e[0].parentNode.rowIndex&&this.parentNode.rowIndex===e[0].parentNode.rowIndex)&&(t=!0),t}))),!1===m||0===t.length}(t):t.is(":visible"),i=t.attr("data-tableexport-display");return o&&"none"!==i&&"always"!==i&&(n=void 0!==(t=e(t[0].parentNode))[0].rowIndex,i=t.attr("data-tableexport-display")),n&&"none"!==i&&"always"!==i&&(i=t.closest("table").attr("data-tableexport-display")),"none"!==i&&(!0===r||"always"===i)}function re(t,n,r){var i=!1;return oe(t)?o.ignoreColumn.length>0&&(-1!==e.inArray(r,o.ignoreColumn)||-1!==e.inArray(r-n,o.ignoreColumn)||f.length>r&&void 0!==f[r]&&-1!==e.inArray(f[r],o.ignoreColumn))&&(i=!0):i=!0,i}function ie(t,n,r,i,a){if("function"==typeof a){var l=!1;if("function"==typeof o.onIgnoreRow&&(l=o.onIgnoreRow(e(t),r)),!1===l&&(0===o.ignoreRow.length||-1===e.inArray(r,o.ignoreRow)&&-1===e.inArray(r-i,o.ignoreRow))&&oe(e(t))){var s=te(e(t),n),c=s.length,d=0,f=0;s.each((function(){var t,n=e(this),o=Se(this),i=Ce(this);if(e.each(h,(function(){var e=this;if(r>e.s.r&&r<=e.e.r&&d>=e.s.c&&d<=e.e.c)for(t=0;t<=e.e.c-e.s.c;++t)c++,f++,a(null,r,d++)})),(i||o)&&(i=i||1,o=o||1,h.push({s:{r,c:d},e:{r:r+i-1,c:d+o-1}})),!1===re(n,c,f++)&&a(this,r,d++),o>1)for(t=0;t<o-1;++t)f++,a(null,r,d++)})),e.each(h,(function(){var e=this;if(r>=e.s.r&&r<=e.e.r&&d>=e.s.c&&d<=e.e.c)for(W=0;W<=e.e.c-e.s.c;++W)a(null,r,d++)}))}}}function ae(e,t,n,o){if(void 0!==o.images){var r=o.images[n];if(void 0!==r){var i=t.getBoundingClientRect(),a=e.width/e.height,l=i.width/i.height,s=e.width,c=e.height,d=19.049976/25.4,f=0;l<=a?(c=Math.min(e.height,i.height),s=i.width*c/i.height):l>a&&(s=Math.min(e.width,i.width),c=i.height*s/i.width),s*=d,(c*=d)<e.height&&(f=(e.height-c)/2);try{o.doc.addImage(r.src,e.textPos.x,e.y+f,s,c)}catch(e){}e.textPos.x+=s}}}function le(e,t){if("string"===o.outputMode)return e.output();if("base64"===o.outputMode)return Ae(e.output());if("window"===o.outputMode)return window.URL=window.URL||window.webkitURL,void window.open(window.URL.createObjectURL(e.output("blob")));try{var n=e.output("blob");saveAs(n,o.fileName+".pdf")}catch(n){Me(o.fileName+".pdf","data:application/pdf"+(t?"":";base64")+",",t?e.output("blob"):e.output())}}function se(e,t,n){var o=0;if(void 0!==n&&(o=n.colspan),o>=0){for(var r=e.width,i=e.textPos.x,a=t.table.columns.indexOf(t.column),l=1;l<o;l++)r+=t.table.columns[a+l].width;if(o>1&&("right"===e.styles.halign?i=e.textPos.x+r-e.width:"center"===e.styles.halign&&(i=e.textPos.x+(r-e.width)/2)),e.width=r,e.textPos.x=i,void 0!==n&&n.rowspan>1&&(e.height=e.height*n.rowspan),"middle"===e.styles.valign||"bottom"===e.styles.valign){var s=("string"==typeof e.text?e.text.split(/\r\n|\r|\n/g):e.text).length||1;s>2&&(e.textPos.y-=.42500000000000004*t.row.styles.fontSize*(s-2)/3)}return!0}return!1}function ce(t,n,o){if(null!=t)if(t.hasAttribute("data-tableexport-canvas")){var r=(new Date).getTime();e(t).attr("data-tableexport-canvas",r),o.images[r]={url:'[data-tableexport-canvas="'+r+'"]',src:null}}else"undefined"!==n&&null!=n&&n.each((function(){if(e(this).is("img")){var n=Oe(this.src);o.images[n]={url:this.src,src:this.src}}ce(t,e(this).children(),o)}))}function de(t,n,r){n.each((function(){if(e(this).is("div")){var n=xe(ke(this,"background-color"),[255,255,255]),i=xe(ke(this,"border-top-color"),[0,0,0]),a=Fe(this,"border-top-width",o.jspdf.unit),l=this.getBoundingClientRect(),s=this.offsetLeft*r.wScaleFactor,c=this.offsetTop*r.hScaleFactor,d=l.width*r.wScaleFactor,f=l.height*r.hScaleFactor;r.doc.setDrawColor.apply(void 0,i),r.doc.setFillColor.apply(void 0,n),r.doc.setLineWidth(a),r.doc.rect(t.x+s,t.y+c,d,f,a?"FD":"F")}else if(e(this).is("img")){var h=Oe(this.src);ae(t,this,h,r)}de(t,e(this).children(),r)}))}function fe(t,n,r){if("function"==typeof r.onAutotableText)r.onAutotableText(r.doc,t,n);else{var i=t.textPos.x,a=t.textPos.y,l={halign:t.styles.halign,valign:t.styles.valign};if(n.length){for(var s=n[0];s.previousSibling;)s=s.previousSibling;for(var c=!1,d=!1;s;){var f=s.innerText||s.textContent||"",h=f.length&&" "===f[0]?" ":"",u=f.length>1&&" "===f[f.length-1]?" ":"";!0!==o.preserve.leadingWS&&(f=h+ue(f)),!0!==o.preserve.trailingWS&&(f=me(f)+u),e(s).is("br")&&(i=t.textPos.x,a+=r.doc.internal.getFontSize()),e(s).is("b")?c=!0:e(s).is("i")&&(d=!0),(c||d)&&r.doc.setFontType(c&&d?"bolditalic":c?"bold":"italic");var m=r.doc.getStringUnitWidth(f)*r.doc.internal.getFontSize();if(m){if("linebreak"===t.styles.overflow&&i>t.textPos.x&&i+m>t.textPos.x+t.width){if(".,!%*;:=-".indexOf(f.charAt(0))>=0){var p=f.charAt(0);i+(m=r.doc.getStringUnitWidth(p)*r.doc.internal.getFontSize())<=t.textPos.x+t.width&&(r.doc.autoTableText(p,i,a,l),f=f.substring(1,f.length)),m=r.doc.getStringUnitWidth(f)*r.doc.internal.getFontSize()}i=t.textPos.x,a+=r.doc.internal.getFontSize()}if("visible"!==t.styles.overflow)for(;f.length&&i+m>t.textPos.x+t.width;)f=f.substring(0,f.length-1),m=r.doc.getStringUnitWidth(f)*r.doc.internal.getFontSize();r.doc.autoTableText(f,i,a,l),i+=m}(c||d)&&(e(s).is("b")?c=!1:e(s).is("i")&&(d=!1),r.doc.setFontType(c||d?c?"bold":"italic":"normal")),s=s.nextSibling}t.textPos.x=i,t.textPos.y=a}else r.doc.autoTableText(t.text,t.textPos.x,t.textPos.y,l)}}function he(e,t,n){return null==e?"":e.toString().replace(new RegExp(function(e){return null==e?"":e.toString().replace(/([.*+?^=!:${}()|\[\]\/\\])/g,"\\$1")}(t),"g"),n)}function ue(e){return null==e?"":e.toString().replace(/^\s+/,"")}function me(e){return null==e?"":e.toString().replace(/\s+$/,"")}function pe(e){if(0===o.date.html.length)return!1;o.date.pattern.lastIndex=0;var t=o.date.pattern.exec(e);if(null==t)return!1;var n=+t[o.date.match_y];if(n<0||n>8099)return!1;var r=1*t[o.date.match_m],i=1*t[o.date.match_d];if(!isFinite(i))return!1;var a=new Date(n,r-1,i,0,0,0);return a.getFullYear()===n&&a.getMonth()===r-1&&a.getDate()===i&&new Date(Date.UTC(n,r-1,i,0,0,0))}function ge(e){return e=e||"0",""!==o.numbers.html.thousandsSeparator&&(e=he(e,o.numbers.html.thousandsSeparator,"")),"."!==o.numbers.html.decimalMark&&(e=he(e,o.numbers.html.decimalMark,".")),("number"==typeof e||!1!==jQuery.isNumeric(e))&&e}function ye(t,n,r,i){var a="",l="text";if(null!==t){var s,c=e(t);if(c.removeData("teUserDefText"),c[0].hasAttribute("data-tableexport-canvas"))s="";else if(c[0].hasAttribute("data-tableexport-value"))s=(s=c.attr("data-tableexport-value"))?s+"":"",c.data("teUserDefText",1);else if(s=c.html(),"function"==typeof o.onCellHtmlData)s=o.onCellHtmlData(c,n,r,s),c.data("teUserDefText",1);else if(""!==s){var d=e.parseHTML(s),f=0,h=0;s="",e.each(d,(function(){if(e(this).is("input"))s+=c.find("input").eq(f++).val();else if(e(this).is("select"))s+=c.find("select option:selected").eq(h++).text();else if(e(this).is("br"))s+="<br>";else if(void 0===e(this).html()?s+=e(this).text():(void 0===jQuery().bootstrapTable||!1===e(this).hasClass("fht-cell")&&!1===e(this).hasClass("filterControl")&&0===c.parents(".detail-view").length)&&(s+=e(this).html()),e(this).is("a")){var t=c.find("a").attr("href")||"";"function"==typeof o.onCellHtmlHyperlink?a+=o.onCellHtmlHyperlink(c,n,r,t,s):"href"===o.htmlHyperlink?a+=t:a+=s,s=""}}))}if(s&&""!==s&&!0===o.htmlContent)a=e.trim(s);else if(s&&""!==s)if(""!==c.attr("data-tableexport-cellformat")){var u=s.replace(/\n/g,"\u2028").replace(/(<\s*br([^>]*)>)/gi,"⁠"),m=e("<div/>").html(u).contents(),p=!1;if(u="",e.each(m.text().split("\u2028"),(function(e,t){e>0&&(u+=" "),!0!==o.preserve.leadingWS&&(t=ue(t)),u+=!0!==o.preserve.trailingWS?me(t):t})),e.each(u.split("⁠"),(function(e,t){e>0&&(a+="\n"),!0!==o.preserve.leadingWS&&(t=ue(t)),!0!==o.preserve.trailingWS&&(t=me(t)),a+=t.replace(/\u00AD/g,"")})),a=a.replace(/\u00A0/g," "),"json"===o.type||"excel"===o.type&&"xmlss"===o.mso.fileFormat||!1===o.numbers.output)!1!==(p=ge(a))&&(l="number",a=Number(p));else if((o.numbers.html.decimalMark!==o.numbers.output.decimalMark||o.numbers.html.thousandsSeparator!==o.numbers.output.thousandsSeparator)&&!1!==(p=ge(a))){var g=(""+p.substr(p<0?1:0)).split(".");1===g.length&&(g[1]="");var y=g[0].length>3?g[0].length%3:0;l="number",a=(p<0?"-":"")+(o.numbers.output.thousandsSeparator?(y?g[0].substr(0,y)+o.numbers.output.thousandsSeparator:"")+g[0].substr(y).replace(/(\d{3})(?=\d)/g,"$1"+o.numbers.output.thousandsSeparator):g[0])+(g[1].length?o.numbers.output.decimalMark+g[1]:"")}}else a=s;!0===o.escape&&(a=escape(a)),"function"==typeof o.onCellData&&(a=o.onCellData(c,n,r,a,l),c.data("teUserDefText",1))}return void 0!==i&&(i.type=l),a}function ve(e){return e.length>0&&!0===o.preventInjection&&"=+-@".indexOf(e.charAt(0))>=0?"'"+e:e}function be(e,t,n){return t+"-"+n.toLowerCase()}function xe(e,t){var n=/^rgb\((\d{1,3}),\s*(\d{1,3}),\s*(\d{1,3})\)$/.exec(e),o=t;return n&&(o=[parseInt(n[1]),parseInt(n[2]),parseInt(n[3])]),o}function we(e){var t=ke(e,"text-align"),n=ke(e,"font-weight"),o=ke(e,"font-style"),r="";"start"===t&&(t="rtl"===ke(e,"direction")?"right":"left"),n>=700&&(r="bold"),"italic"===o&&(r+=o),""===r&&(r="normal");var i={style:{align:t,bcolor:xe(ke(e,"background-color"),[255,255,255]),color:xe(ke(e,"color"),[0,0,0]),fstyle:r},colspan:Se(e),rowspan:Ce(e)};if(null!==e){var a=e.getBoundingClientRect();i.rect={width:a.width,height:a.height}}return i}function Se(t){var n=e(t).attr("data-tableexport-colspan");return void 0===n&&e(t).is("[colspan]")&&(n=e(t).attr("colspan")),parseInt(n)||0}function Ce(t){var n=e(t).attr("data-tableexport-rowspan");return void 0===n&&e(t).is("[rowspan]")&&(n=e(t).attr("rowspan")),parseInt(n)||0}function ke(e,t){try{return window.getComputedStyle?(t=t.replace(/([a-z])([A-Z])/,be),window.getComputedStyle(e,null).getPropertyValue(t)):e.currentStyle?e.currentStyle[t]:e.style[t]}catch(e){}return""}function Fe(e,t,n){var o=ke(e,t).match(/\d+/);return null!==o?(o=o[0],function(e,t,n){var o=document.createElement("div");o.style.overflow="hidden",o.style.visibility="hidden",e.appendChild(o),o.style.width=100+n;var r=100/o.offsetWidth;return e.removeChild(o),t*r}(e.parentElement,o,n)):0}function Te(e){return function(e){var t="";for(++e;e;e=Math.floor((e-1)/26))t=String.fromCharCode((e-1)%26+65)+t;return t}(e.c)+""+(e.r+1)}function Ne(e,t){return void 0===t||"number"==typeof t?Ne(e.s,e.e):("string"!=typeof e&&(e=Te(e)),"string"!=typeof t&&(t=Te(t)),e===t?e:e+":"+t)}function Re(e,t){var n=Number(e);if(isFinite(n))return n;var o=1,r=e;return""!==t.thousandsSeparator&&(r=r.replace(new RegExp("([\\d])"+t.thousandsSeparator+"([\\d])","g"),"$1$2")),"."!==t.decimalMark&&(r=r.replace(new RegExp("([\\d])"+t.decimalMark+"([\\d])","g"),"$1.$2")),r=r.replace(/[$]/g,"").replace(/[%]/g,(function(){return o*=100,""})),isFinite(n=Number(r))?n/o:(r=r.replace(/[(](.*)[)]/,(function(e,t){return o=-o,t})),isFinite(n=Number(r))?n/o:n)}function Oe(e){var t,n,o=0;if(0===e.length)return o;for(t=0,n=e.length;t<n;t++)o=(o<<5)-o+e.charCodeAt(t),o|=0;return o}function Ee(e,t,r,i,a,l){var s=!0;if("function"==typeof o.onBeforeSaveToFile&&"boolean"!=typeof(s=o.onBeforeSaveToFile(e,t,r,i,a))&&(s=!0),s)try{n=new Blob([e],{type:r+";charset="+i}),saveAs(n,t,!1===l),"function"==typeof o.onAfterSaveToFile&&o.onAfterSaveToFile(e,t)}catch(n){Me(t,"data:"+r+(i.length?";charset="+i:"")+(a.length?";"+a:"")+",",l?"\ufeff"+e:e)}}function Me(e,t,n){var r=window.navigator.userAgent;if(!1!==e&&window.navigator.msSaveOrOpenBlob)window.navigator.msSaveOrOpenBlob(new Blob([n]),e);else if(!1!==e&&(r.indexOf("MSIE ")>0||r.match(/Trident.*rv\:11\./))){var i=document.createElement("iframe");if(i){switch(document.body.appendChild(i),i.setAttribute("style","display:none"),i.contentDocument.open("txt/plain","replace"),i.contentDocument.write(n),i.contentDocument.close(),i.contentWindow.focus(),e.substr(e.lastIndexOf(".")+1)){case"doc":case"json":case"png":case"pdf":case"xls":case"xlsx":e+=".txt"}i.contentDocument.execCommand("SaveAs",!0,e),document.body.removeChild(i)}}else{var l=document.createElement("a");if(l){var s=null;if(l.style.display="none",!1!==e?l.download=e:l.target="_blank","object"==typeof n){window.URL=window.URL||window.webkitURL;var c=[];c.push(n),s=window.URL.createObjectURL(new Blob(c,{type:t})),l.href=s}else t.toLowerCase().indexOf("base64,")>=0?l.href=t+Ae(n):l.href=t+encodeURIComponent(n);document.body.appendChild(l),document.createEvent?(null===a&&(a=document.createEvent("MouseEvents")),a.initEvent("click",!0,!1),l.dispatchEvent(a)):document.createEventObject?l.fireEvent("onclick"):"function"==typeof l.onclick&&l.onclick(),setTimeout((function(){s&&window.URL.revokeObjectURL(s),document.body.removeChild(l),"function"==typeof o.onAfterSaveToFile&&o.onAfterSaveToFile(n,e)}),100)}}}function Ae(e){var t,n,o,r,i,a,l,s="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=",c="",d=0;for(e=function(e){if("string"==typeof e){e=e.replace(/\x0d\x0a/g,"\n");for(var t="",n=0;n<e.length;n++){var o=e.charCodeAt(n);o<128?t+=String.fromCharCode(o):o>127&&o<2048?(t+=String.fromCharCode(o>>6|192),t+=String.fromCharCode(63&o|128)):(t+=String.fromCharCode(o>>12|224),t+=String.fromCharCode(o>>6&63|128),t+=String.fromCharCode(63&o|128))}return t}return e}(e);d<e.length;)r=(t=e.charCodeAt(d++))>>2,i=(3&t)<<4|(n=e.charCodeAt(d++))>>4,a=(15&n)<<2|(o=e.charCodeAt(d++))>>6,l=63&o,isNaN(n)?a=l=64:isNaN(o)&&(l=64),c=c+s.charAt(r)+s.charAt(i)+s.charAt(a)+s.charAt(l);return c}return"function"==typeof o.onTableExportEnd&&o.onTableExportEnd(),this}}(jQuery);